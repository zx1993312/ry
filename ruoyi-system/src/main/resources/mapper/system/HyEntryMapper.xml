<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.HyEntryMapper">
    
    <resultMap type="HyEntry" id="HyEntryResult">
        <result property="id"    column="id"    />
        <result property="entryType"    column="entry_type"    />
        <result property="entryDate"    column="entry_date"    />
        <result property="entryPerson"    column="entry_person"    />
        <result property="entryRange"    column="entry_range"    />
        <result property="entryDateStr"    column="entry_date_str"    />
        <result property="entryDateEnd"    column="entry_date_end"    />
        <result property="entryAmount"    column="entry_amount"    />
        <result property="costId"    column="cost_id"    />
        <result property="auditId"    column="audit_id"    />
        <association property="hyCost" column="id" javaType="HyCost" resultMap="HyCostResult" />
		<association property="hyAuditManagement" column="id" javaType="HyAuditManagement" resultMap="HyAuditManagementResult" />
        
    </resultMap>
    
    <resultMap type="HyCost" id="HyCostResult">
		<result property="id" column="id" />
		<result property="costItems" column="cost_items" />
		<result property="expenseType" column="expense_type" />
		<result property="parentId" column="parent_id" />
		<result property="ancestors" column="ancestors" />
		<result property="standardName" column="standard_name" />
		<result property="feeNum" column="fee_num" />
		<result property="chargingStandard" column="charging_standard" />
		<result property="calculationMehod" column="calculation_mehod" />
		<result property="standardDescription"
			column="standard_description" />
		<result property="standardState" column="standard_state" />
		<result property="proportionDamags" column="proportion_damags" />
		<result property="projectModification"
			column="project_modification" />
		<result property="billingCycle" column="billing_cycle" />
		<result property="bilingStartDate" column="biling_start_date" />
		<result property="bilingEndDate" column="biling_end_date" />
		<result property="auditResultsReason"
			column="audit_results_reason" />
		<result property="feeDateOld" column="fee_date_old" />
		<result property="feeDate" column="fee_date" />
		<result property="dueDateOld" column="due_date_old" />
		<result property="dueDate" column="due_date" />
		<result property="amountReceivableOld"
			column="amount_receivable_old" />
		<result property="amountReceivable" column="amount_receivable" />
		<result property="amountActually" column="amount_actually" />
		<result property="remarks" column="remarks" />
		<result property="operationDate" column="operation_date" />
		<result property="operationUser" column="operation_user" />
		<result property="operationType" column="operation_type" />
		<result property="deleteReason" column="delete_reason" />
		<result property="advancePaymetnOffset"
			column="advance_paymetn_offset" />
		<result property="writeOff" column="write_off" />
		<result property="refundAmount" column="refund_amount" />
		<result property="amountArrears" column="amount_arrears" />
		<result property="collectionStatus" column="collection_status" />
		<result property="frozenPerson" column="frozen_person" />
		<result property="frozenState" column="frozen_state" />
		<result property="frozenDate" column="frozen_date" />
		<result property="frozenReason" column="frozen_reason" />
		<result property="advanceStatus" column="advance_status" />
		<result property="deliveryStatus" column="delivery_status" />
		<result property="transferTenants" column="transfer_tenants" />
		<result property="changeDate" column="change_date" />

	</resultMap>
    
		
    <resultMap type="HyAuditManagement" id="HyAuditManagementResult">
        <result property="id"    column="id"    />
        <result property="auditProcess"    column="audit_process"    />
        <result property="auditStatus"    column="audit_status"    />
    </resultMap>

    <sql id="selectHyEntryVo">
        select 
        e.id, 
        e.entry_type, 
        e.entry_date, 
        e.entry_person, 
        e.entry_range, 
        e.entry_date_str, 
        e.entry_date_end, 
        e.entry_amount, 
        e.cost_id,
        e.audit_id,
        c.amount_receivable,
        c.cost_items,
        a.audit_process,
        a.audit_status
        from hy_entry e 
        left join hy_audit_management a on e.audit_id=a.id
        left join hy_cost c on e.cost_id=c.id
        where 1=1
    </sql>

    <select id="selectHyEntryList" parameterType="HyEntry" resultMap="HyEntryResult">
        <include refid="selectHyEntryVo"/>
     
            <if test="entryType != null "> and e.entry_type = #{entryType}</if>
            <if test="entryDate != null "> and e.entry_date = #{entryDate}</if>
            <if test="entryPerson != null  and entryPerson != ''"> and e.entry_person = #{entryPerson}</if>
            <if test="entryRange != null  and entryRange != ''"> and e.entry_range = #{entryRange}</if>
            <if test="entryDateStr != null "> and e.entry_date_str = #{entryDateStr}</if>
            <if test="entryDateEnd != null "> and e.entry_date_end = #{entryDateEnd}</if>
            <if test="entryAmount != null  and entryAmount != ''"> and e.entry_amount = #{entryAmount}</if>
            <if test="costId != null  and costId != ''"> and e.cost_id = #{costId}</if>
            <if test="auditId != null  and auditId != ''"> and e.audit_id = #{auditId}</if>
        
    </select>
    
    <select id="selectHyEntryById" parameterType="Long" resultMap="HyEntryResult">
        <include refid="selectHyEntryVo"/>
        where e.id = #{id}
    </select>
        
    <insert id="insertHyEntry" parameterType="HyEntry" useGeneratedKeys="true" keyProperty="id">
        insert into hy_entry
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="entryType != null">entry_type,</if>
            <if test="entryDate != null">entry_date,</if>
            <if test="entryPerson != null">entry_person,</if>
            <if test="entryRange != null">entry_range,</if>
            <if test="entryDateStr != null">entry_date_str,</if>
            <if test="entryDateEnd != null">entry_date_end,</if>
            <if test="entryAmount != null">entry_amount,</if>
            <if test="costId != null">cost_id,</if>
            <if test="auditId != null">audit_id,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="entryType != null">#{entryType},</if>
            <if test="entryDate != null">#{entryDate},</if>
            <if test="entryPerson != null">#{entryPerson},</if>
            <if test="entryRange != null">#{entryRange},</if>
            <if test="entryDateStr != null">#{entryDateStr},</if>
            <if test="entryDateEnd != null">#{entryDateEnd},</if>
            <if test="entryAmount != null">#{entryAmount},</if>
            <if test="costId != null">#{costId},</if>
            <if test="auditId != null">#{auditId},</if>
         </trim>
    </insert>

    <update id="updateHyEntry" parameterType="HyEntry">
        update hy_entry
        <trim prefix="SET" suffixOverrides=",">
            <if test="entryType != null">entry_type = #{entryType},</if>
            <if test="entryDate != null">entry_date = #{entryDate},</if>
            <if test="entryPerson != null">entry_person = #{entryPerson},</if>
            <if test="entryRange != null">entry_range = #{entryRange},</if>
            <if test="entryDateStr != null">entry_date_str = #{entryDateStr},</if>
            <if test="entryDateEnd != null">entry_date_end = #{entryDateEnd},</if>
            <if test="entryAmount != null">entry_amount = #{entryAmount},</if>
            <if test="costId != null">cost_id = #{costId},</if>
            <if test="auditId != null">audit_id = #{auditId},</if>
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteHyEntryById" parameterType="Long">
        delete from hy_entry where id = #{id}
    </delete>

    <delete id="deleteHyEntryByIds" parameterType="String">
        delete from hy_entry where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

</mapper>